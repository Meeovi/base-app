"use strict";const _="app.grapesjs.com",N="app-stage.grapesjs.com",D="app2.grapesjs.com",R="app-stage2.grapesjs.com",C=[_,D,N,R,"localhost","127.0.0.1",".local-credentialless.webcontainer.io",".local.webcontainer.io","-sandpack.codesandbox.io"],S="license:check:start",x="license:check:end",O=()=>typeof window<"u",U=({isDev:e,isStage:s})=>`${e?"":`https://${s?N:_}`}/api`,W=()=>{const e=O()&&window.location.hostname;return!!e&&(C.includes(e)||C.some(s=>e.endsWith(s)))};async function j({path:e,baseApiUrl:s,method:i="GET",headers:t={},params:o,body:a}){const c=`${s||U({isDev:!1,isStage:!1})}${e}`,l={method:i,headers:{"Content-Type":"application/json",...t}};a&&(l.body=JSON.stringify(a));const u=o?new URLSearchParams(o).toString():"",n=u?`?${u}`:"",r=await fetch(`${c}${n}`,l);if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);return r.json()}var h=(e=>(e.free="free",e.startup="startup",e.business="business",e.enterprise="enterprise",e))(h||{});const M={[h.free]:0,[h.startup]:10,[h.business]:20,[h.enterprise]:30};function B(e){const s=e;return s.init=i=>t=>e(t,i),s}const K=e=>B(e);async function G({editor:e,plan:s,pluginName:i,licenseKey:t,cleanup:o}){let a="",p=!1;const c=W(),l=n=>{console.warn("Cleanup plugin:",i,"Reason:",n),o()},u=(n={})=>{var P;const{error:r,sdkLicense:I}=n,f=(P=n.plan)==null?void 0:P.category;if(!(I||n.license)||r)l(r||"Invalid license");else if(f){const A=M[s],b=M[f];A>b&&l({pluginRequiredPlan:s,licensePlan:f})}};e.on(S,n=>{a=n==null?void 0:n.baseApiUrl,p=!0}),e.on(x,n=>{u(n)}),setTimeout(async()=>{if(!p){if(c)return;if(t){const n=await F({licenseKey:t,pluginName:i,baseApiUrl:a});n&&u(n)}else l("The `licenseKey` option not provided")}},2e3)}async function F(e){const{licenseKey:s,pluginName:i,baseApiUrl:t}=e;try{return(await j({baseApiUrl:t,path:`/sdk/${s||"na"}`,method:"POST",params:{d:window.location.hostname,pn:i}})).result||{}}catch(o){return console.error("Error during SDK license check:",o),!1}}const v="gjs-plg-",q="listPagesComponent",X=h.startup;function Y(e,s,i){let t,o,a,p,c;const l=s;function u(){const r=Date.now()-p;r<l&&r>=0?t=setTimeout(u,l-r):(t=null,c=e.apply(a,o),a=o=null)}const n=function(){return a=this,o=arguments,p=Date.now(),t||(t=setTimeout(u,l)),c};return n.clear=function(){t&&(clearTimeout(t),t=null)},n.flush=function(){t&&(c=e.apply(a,o),a=o=null,clearTimeout(t),t=null)},n}const k="page://",m="list-pages",d="list-pages-item",g="list-pages-link",Z=e=>e.components().reduce((s,i)=>{var p;const t=i.findFirstType(g),o=(p=t==null?void 0:t.attributes.attributes)==null?void 0:p.href,a=o!=null&&o.startsWith(k)?o.replace(k,""):"";if(a&&t){const c=s[a];c?c.push(t):s[a]=[t]}return s},{}),T="data-type-role",J="page_root",z=e=>s=>s.is(e),Q=e=>(s,i)=>i.is(e),w=e=>s=>{var i;return((i=s.getAttribute)==null?void 0:i.call(s,T))===e},ee=function(e,s={}){const{Blocks:i,Components:t,Pages:o}=e,{licenseKey:a,block:p={}}=s,c="List Pages",l="List Pages Item",u="Link",n=`${v}${m}`,r=`${v}${g}`,I='<svg viewBox="0 0 24 24"><path d="M11 15H17V17H11V15M9 7H7V9H9V7M11 13H17V11H11V13M11 9H17V7H11V9M9 11H7V13H9V11M21 5V19C21 20.1 20.1 21 19 21H5C3.9 21 3 20.1 3 19V5C3 3.9 3.9 3 5 3H19C20.1 3 21 3.9 21 5M19 5H5V19H19V5M9 15H7V17H9V15Z"/></svg>',f='<svg viewBox="0 0 24 24"><path d="M7,5H21V7H7V5M7,13V11H21V13H7M4,4.5A1.5,1.5 0 0,1 5.5,6A1.5,1.5 0 0,1 4,7.5A1.5,1.5 0 0,1 2.5,6A1.5,1.5 0 0,1 4,4.5M4,10.5A1.5,1.5 0 0,1 5.5,12A1.5,1.5 0 0,1 4,13.5A1.5,1.5 0 0,1 2.5,12A1.5,1.5 0 0,1 4,10.5M7,19V17H21V19H7M4,16.5A1.5,1.5 0 0,1 5.5,18A1.5,1.5 0 0,1 4,19.5A1.5,1.5 0 0,1 2.5,18A1.5,1.5 0 0,1 4,16.5Z" /></svg>';t.addType(m,{block:p&&{label:c,media:I,category:"Extra",select:!0,...s.block},isComponent:w(m),model:{defaults:{tagName:"ul",name:c,[J]:"",classes:n,attributes:{[T]:m,role:"navigation"},droppable:z(d),styles:`
          .${n} {
            list-style: none;
            margin: 0;
            padding: 0;
          }
        `},init(){this.syncPageItems=Y(this.syncPageItems.bind(this),0),this.listenTo(this.em,o.events.all,this.syncPageItems),this.syncPageItems()},syncPageItems(){if(e.Components.getSymbolInfo(this).isInstance)return;const y=this.em.Pages.getAll(),P=this.components(),A=Z(this);y.forEach((b,$)=>{const E=b.id,H=b.getName(),L=A[E];L?L==null||L.forEach(V=>{V.getInnerHTML()!==H&&V.components(H)}):P.add({type:d,components:[{type:g,attributes:{href:`page://${E}`},components:{type:"textnode",content:H}}]},{at:$})})}}}),t.addType(d,{isComponent:w(d),model:{defaults:{name:l,tagName:"li",icon:f,attributes:{[T]:d},components:{type:g},draggable:Q(m)}}}),t.addType(g,{extend:"link",isComponent:w(g),model:{defaults:{removable:!1,copyable:!1,delegate:{move:y=>y.closestType(d)},name:u,classes:r,attributes:{[T]:g},components:{type:"textnode",content:"Item"},styles:`
          .${r} {
            text-decoration: none;
          }
        `}}}),G({editor:e,licenseKey:a,plan:X,pluginName:q,cleanup:()=>{i.remove(m),t.removeType(m)}})},te=K(ee);module.exports=te;
