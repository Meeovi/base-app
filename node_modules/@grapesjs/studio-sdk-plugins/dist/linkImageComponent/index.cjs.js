"use strict";const T="app.grapesjs.com",A="app-stage.grapesjs.com",v="app2.grapesjs.com",I="app-stage2.grapesjs.com",y=[T,v,A,I,"localhost","127.0.0.1",".local-credentialless.webcontainer.io",".local.webcontainer.io","-sandpack.codesandbox.io"],C="license:check:start",L="license:check:end",N=()=>typeof window<"u",D=({isDev:e,isStage:s})=>`${e?"":`https://${s?A:T}`}/api`,E=()=>{const e=N()&&window.location.hostname;return!!e&&(y.includes(e)||y.some(s=>e.endsWith(s)))};async function U({path:e,baseApiUrl:s,method:i="GET",headers:o={},params:a,body:c}){const g=`${s||D({isDev:!1,isStage:!1})}${e}`,r={method:i,headers:{"Content-Type":"application/json",...o}};c&&(r.body=JSON.stringify(c));const m=a?new URLSearchParams(a).toString():"",t=m?`?${m}`:"",l=await fetch(`${g}${t}`,r);if(!l.ok)throw new Error(`HTTP error! status: ${l.status}`);return l.json()}var h=(e=>(e.free="free",e.startup="startup",e.business="business",e.enterprise="enterprise",e))(h||{});const k={[h.free]:0,[h.startup]:10,[h.business]:20,[h.enterprise]:30};function $(e){const s=e;return s.init=i=>o=>e(o,i),s}const P=e=>$(e);async function _({editor:e,plan:s,pluginName:i,licenseKey:o,cleanup:a}){let c="",p=!1;const g=E(),r=t=>{console.warn("Cleanup plugin:",i,"Reason:",t),a()},m=(t={})=>{var d;const{error:l,sdkLicense:b}=t,n=(d=t.plan)==null?void 0:d.category;if(!(b||t.license)||l)r(l||"Invalid license");else if(n){const w=k[s],f=k[n];w>f&&r({pluginRequiredPlan:s,licensePlan:n})}};e.on(C,t=>{c=t==null?void 0:t.baseApiUrl,p=!0}),e.on(L,t=>{m(t)}),setTimeout(async()=>{if(!p){if(g)return;if(o){const t=await x({licenseKey:o,pluginName:i,baseApiUrl:c});t&&m(t)}else r("The `licenseKey` option not provided")}},2e3)}async function x(e){const{licenseKey:s,pluginName:i,baseApiUrl:o}=e;try{return(await U({baseApiUrl:o,path:`/sdk/${s||"na"}`,method:"POST",params:{d:window.location.hostname,pn:i}})).result||{}}catch(a){return console.error("Error during SDK license check:",a),!1}}const S="linkImageComponent",O=h.startup,W=function(e,s={}){const{Components:i,Blocks:o}=e,a="link-image",c="Link Image",p="link-image",{model:g,view:r}=e.Components.getType("image"),m=i.getType("link").model.getDefaults().traits,t=g.getDefaults().traits,l=m.filter(n=>n!=="title"),b=t.filter(n=>n.name!=="customAttributes").map(n=>typeof n=="string"?{name:n}:n).map(n=>({...n,getValue({component:u}){var d;return(d=u.components().at(0).getTrait(n.name))==null?void 0:d.getValue()},setValue({component:u,value:d,options:w}){var f;(f=u.components().at(0).getTrait(n.name))==null||f.setValue(d,w)}}));i.addType(a,{isComponent:n=>{var u;return n.tagName==="A"&&((u=n.children)==null?void 0:u.length)===1&&n.children[0].tagName==="IMG"},block:{label:c,media:'<svg viewBox="0 0 24 24"><path fill="currentColor" d="M2 6.3A2.3 2.3 0 0 1 4.3 4h15.4A2.3 2.3 0 0 1 22 6.3v7a4.7 4.7 0 0 0-2.8-.8h-3.4a4.8 4.8 0 0 0-4 7.5H4.3A2.3 2.3 0 0 1 2 17.7zm21 11a3.8 3.8 0 0 0-3.8-3.8.8.8 0 0 0 0 1.5h.2a2.3 2.3 0 0 1-.1 4.5H19a.8.8 0 0 0 .2 1.5h.2a3.8 3.8 0 0 0 3.5-3.8m-6.5-3a.8.8 0 0 0-.8-.7h-.1a3.8 3.8 0 0 0 .2 7.5.8.8 0 0 0 0-1.5h-.2a2.3 2.3 0 0 1 .2-4.5.8.8 0 0 0 .7-.7m3.5 3a.8.8 0 0 0-.8-.8h-3.6a.8.8 0 0 0 .2 1.5h3.6a.8.8 0 0 0 .6-.8"/></svg>'},extend:"link",extendFn:["init"],model:{defaults:{name:c,classes:p,resizable:{ratioDefault:!0},traits:[...b,...l],droppable:!1,stylable:["width","min-width","max-width","height","min-height","max-height","padding","margin","position","border-radius","border-width","border-style","border-color","opacity","box-shadow","filter","transform"],components:{type:"image"},styles:`
          .${p} {
            display: inline-block;
            overflow: hidden;
          }
          .${p} > img {
            object-fit: cover;
            display: block;
            width: 100%;
            height: 100%;
          }
        `},init(){const n=this.components().at(0);n==null||n.set({layerable:!1,locked:!0})}},view:{onActive(n){r.prototype.onActive.call(this,n)}}}),_({editor:e,licenseKey:s.licenseKey,plan:O,pluginName:S,cleanup:()=>{i.removeType(a),o.remove(a)}})},j=P(W);module.exports=j;
