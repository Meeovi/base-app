"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const D=require("@vueuse/core"),k=require("tabbable"),f=require("vue"),c=require("@storefront-ui/shared"),K=require("../../shared/render.cjs.js");var A=(r=>(r.autofocus="autofocus",r.container="container",r))(A||{});const P={trapTabs:!0,activeState:f.ref(!0),initialFocus:0,initialFocusContainerFallback:!1,arrowKeysLeftRight:!1,arrowKeysUpDown:!1},C=(r,S)=>{const{trapTabs:b,arrowFocusGroupSelector:l,includeContainer:d,activeState:g,initialFocus:t,arrowKeysLeftRight:w,arrowKeysUpDown:y,initialFocusContainerFallback:q}={...P,...S},i=f.ref(),o=f.ref([]);let e;const p=()=>{i.value=document.activeElement},n=({event:s,additionalData:a})=>c.focusPrev({current:i.value,focusables:o.value,event:s,...a}),v=({event:s,additionalData:a})=>c.focusNext({current:i.value,focusables:o.value,event:s,...a}),F=s=>{const u=l&&(e==null?void 0:e.querySelector(l))?{arrowFocusGroupSelector:l}:{};w&&s.key==="ArrowLeft"&&n({additionalData:u}),w&&s.key==="ArrowRight"&&v({additionalData:u}),y&&s.key==="ArrowUp"&&n({additionalData:u}),y&&s.key==="ArrowDown"&&v({additionalData:u}),b&&c.isTab(s)&&v({event:s}),b&&c.isTabAndShift(s)&&n({event:s})},x=()=>{e==null||e.removeEventListener("keydown",F),e==null||e.removeEventListener("focus",p,!0)};f.watch([r,g],async([s,a])=>{if(s&&a){let u=!1;if(await K.waitForNextRender(),e=D.unrefElement(s),e==null||e.addEventListener("focus",p,!0),e==null||e.addEventListener("keydown",F),o.value=k.tabbable(e,{includeContainer:d}),typeof t=="number")o.value[t]?o.value[t].focus():(console.error(`There is no element with given index ${t}`),u=!0);else if(t==="autofocus"){const h=o.value.find(m=>m.hasAttribute("autofocus"));h?h.focus():u=!0}(q&&u||t==="container")&&(e==null||e.focus())}else o.value=[],i.value=void 0,x()},{immediate:!0});const N=()=>{o.value=k.tabbable(r.value,{includeContainer:d})};return{current:i,focusables:o,focusNext:c.focusNext,focusPrev:c.focusPrev,updateFocusableElements:N}};exports.InitialFocusType=A;exports.useTrapFocus=C;
