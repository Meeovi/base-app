"use strict";var e,t=Object.defineProperty,n=Object.getOwnPropertyDescriptor,o=Object.getOwnPropertyNames,s=Object.prototype.hasOwnProperty,r={};((e,n)=>{for(var o in n)t(e,o,{get:n[o],enumerable:!0})})(r,{PolarEmbedCheckout:()=>i}),module.exports=(e=r,((e,r,a,i)=>{if(r&&"object"==typeof r||"function"==typeof r)for(let d of o(r))s.call(e,d)||d===a||t(e,d,{get:()=>r[d],enumerable:!(i=n(r,d))||i.enumerable});return e})(t({},"__esModule",{value:!0}),e));var a="POLAR_CHECKOUT",i=class e{iframe;loader;loaded;closable;eventTarget;constructor(e,t){this.iframe=e,this.loader=t,this.loaded=!1,this.closable=!0,this.eventTarget=new EventTarget,this.initWindowListener(),this.addEventListener("loaded",this.loadedListener.bind(this)),this.addEventListener("close",this.closeListener.bind(this)),this.addEventListener("confirmed",this.confirmedListener.bind(this)),this.addEventListener("success",this.successListener.bind(this))}static postMessage(e,t){window.parent.postMessage({...e,type:a},t)}static async create(t,n){const o=document.createElement("style");o.innerText=`\n      .polar-loader-spinner {\n        width: 20px;\n        aspect-ratio: 1;\n        border-radius: 50%;\n        background: ${"dark"===n?"#000":"#fff"};\n        box-shadow: 0 0 0 0 ${"dark"===n?"#fff":"#000"};\n        animation: polar-loader-spinner-animation 1s infinite;\n      }\n      @keyframes polar-loader-spinner-animation {\n        100% {box-shadow: 0 0 0 30px #0000}\n      }\n      body.polar-no-scroll {\n        overflow: hidden;\n      }\n    `,document.head.appendChild(o);const s=document.createElement("div");s.style.position="absolute",s.style.top="50%",s.style.left="50%",s.style.transform="translate(-50%, -50%)",s.style.zIndex="2147483647",s.style.colorScheme="auto";const r=document.createElement("div");r.className="polar-loader-spinner",s.appendChild(r),document.body.classList.add("polar-no-scroll"),document.body.appendChild(s);const a=new URL(t);a.searchParams.set("embed","true"),a.searchParams.set("embed_origin",window.location.origin),n&&a.searchParams.set("theme",n);const i=a.toString(),d=document.createElement("iframe");d.src=i,d.style.position="fixed",d.style.top="0",d.style.left="0",d.style.width="100%",d.style.height="100%",d.style.border="none",d.style.zIndex="2147483647",d.style.backgroundColor="rgba(0, 0, 0, 0.5)",d.style.colorScheme="auto";const l="https://polar.sh,https://sandbox.polar.sh".split(",").join(" ");d.allow=`payment 'self' ${l}; publickey-credentials-get 'self' ${l};`,document.body.appendChild(d);const c=new e(d,s);return new Promise(e=>{c.addEventListener("loaded",()=>e(c),{once:!0})})}static init(){document.querySelectorAll("[data-polar-checkout]").forEach(t=>{t.removeEventListener("click",e.checkoutElementClickHandler),t.addEventListener("click",e.checkoutElementClickHandler)})}close(){document.body.contains(this.iframe)&&document.body.removeChild(this.iframe),document.body.classList.remove("polar-no-scroll")}addEventListener(e,t,n){this.eventTarget.addEventListener(e,t,n)}removeEventListener(e,t){this.eventTarget.removeEventListener(e,t)}static async checkoutElementClickHandler(t){t.preventDefault();let n=t.target;for(;!n.hasAttribute("data-polar-checkout");){if(!n.parentElement)return;n=n.parentElement}const o=n.getAttribute("href")||n.getAttribute("data-polar-checkout"),s=n.getAttribute("data-polar-checkout-theme");e.create(o,s)}loadedListener(e){e.defaultPrevented||this.loaded||(document.body.removeChild(this.loader),this.loaded=!0)}closeListener(e){e.defaultPrevented||this.closable&&this.close()}confirmedListener(e){e.defaultPrevented||(this.closable=!1)}successListener(e){e.defaultPrevented||(this.closable=!0,e.detail.redirect&&(window.location.href=e.detail.successURL))}initWindowListener(){window.addEventListener("message",({data:e,origin:t})=>{"https://polar.sh,https://sandbox.polar.sh".split(",").includes(t)&&(e.type===a&&this.eventTarget.dispatchEvent(new CustomEvent(e.event,{detail:e,cancelable:!0})))})}};if("undefined"!=typeof window&&(window.Polar={EmbedCheckout:i}),"undefined"!=typeof document){const e=document.currentScript;e&&e.hasAttribute("data-auto-init")&&document.addEventListener("DOMContentLoaded",async()=>{i.init()})}